@model Suma2Lealtad.Models.PrepagoCompanyAffiliattes

@{
    ViewBag.Title = "RecargaIndividual";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@*<link href="css/bootstrap.css" rel="stylesheet">*@
<link href="~/Content/bootstrap.css" rel="stylesheet" />
@*<link href="css/style.css" rel="stylesheet">*@
<link href="~/Content/style.css" rel="stylesheet" />

<style type="text/css" media="screen">
    .table-hover {
        cursor: pointer;
    }

    .table tbody tr.active td {
        background-color: #1C2B2B; /*#476B6B #29A329;*/
        color: white;
    }
</style>


<div class="form-group">

    <div class="panel panel-default">

        <div class="panel-heading clearfix panel-gradient">
            @*<h3 class="panel-title">Afiliado  @Model.DocId / Saldos <a href="@Url.Action("Index", "Afiliado", new { numdoc = Model.DocId })" class="btn btn-success btn-md">Regresar</a></h3>*@
            <h3 class="panel-title">Prepago / Compañia / Beneficiarios / Recarga Individual</h3>
            @*<input type="submit" class="btn btn-success btn-md" value="Regresar" style="padding-right: 15px; padding-left: 15px; margin-left: 0px;" />*@
        </div>

        <div class="panel-body">

            <form id="commentForm" method="post" action="@Url.Action("RecargaIndividual", "CompanyPrepago")" class="form-horizontal" onsubmit="return ValidarMontos();">

                <div class="form-group">

                    @Html.HiddenFor(model => model.companyid)

                    <div class="editor-label col-md-4 control-label">
                        Compañia :
                    </div>

                    <div class="editor-field col-md-6">
                        @Html.TextBoxFor(model => model.namecompañia, new { @class = "form-control", @readonly = "true" })
                    </div>

                    <div class="editor-label col-md-4 control-label">
                        RIF :
                    </div>
                    <div class="editor-form col-md-6">
                        @Html.TextBoxFor(model => model.rif, new { @class = "form-control", @readonly = "true" })
                    </div>
                    <div class="editor-label col-md-4 control-label">
                        Teléfono :
                    </div>
                    <div class="editor-form col-md-6">
                        @Html.TextBoxFor(model => model.phone, new { @class = "form-control", @readonly = "true" })
                    </div>

                    <div class="editor-label col-md-4 control-label"></div>
                    <div class="editor-field col-md-6">
                        <br />
                    </div>

                    <div class="col-md-12 col-tabla-btn">
                        <div class="pull-right">
                            @*<a href="@Url.Action("", "")" class="btn btn-success btn-md">Órdenes de Recarga</a>
                        <a href="@Url.Action("", "")" class="btn btn-success btn-md">Recarga Individual</a>
                        <a href="@Url.Action("", "")" class="btn btn-success btn-md">Recarga Masiva</a>
                        <a href="@Url.Action("Filter", "CompanyPrepago", new { companyid = Model.companyid })" class="btn btn-success btn-md">Agregar Nuevo Beneficiario</a>*@
                            <a href="@Url.Action("FilterBeneficiarios", "CompanyPrepago", new { companyid = Model.companyid })" class="btn btn-success btn-md">Filtrar Beneficiarios</a>
                            <a href="@Url.Action("FilterCompany", "CompanyPrepago")" class="btn btn-danger btn-md">Cancelar</a>
                        </div>
                    </div>


                    <div class="editor-field col-md-6">
                        <br />
                    </div>

                    @*<table class="table table-striped custab">*@
                    <table id="beneficiarios" class="table table-hover">

                        <thead>
                            <tr>
                                <th>Tipo</th>
                                <th>Número de Documento</th>
                                <th>Nombre</th>
                                @*<th>Correo</th>
                        <th>Estatus de Afiliación</th>
                        <th>Número de Tarjeta</th>
                        <th>Estatus de Tarjeta</th>*@
                                <th>Monto</th>
                            </tr>
                        </thead>

                        <tbody>

                            @foreach (var item in Model.Beneficiarios)
                            {                            
                                <tr data-row-key="@item.id" data-statusafiliacion="@item.estatus" data-statustarjeta="@item.estatustarjeta">
                                    <td>
                                        @Html.DisplayFor(modelItem => item.type)
                                    </td>

                                    <td>
                                        @Html.DisplayFor(modelItem => item.docnumber)
                                    </td>

                                    <td>
                                        @Html.DisplayFor(modelItem => item.name) @Html.DisplayFor(modelItem => item.lastname1)
                                    </td>

                                    @*<td>
                                @Html.DisplayFor(modelItem => item.email)
                            </td>

                            <td>
                                @Html.DisplayFor(modelItem => item.estatus)
                            </td>

                            <td>
                                @Html.DisplayFor(modelItem => item.pan)
                            </td>

                            <td>
                                @Html.DisplayFor(modelItem => item.estatustarjeta)
                            </td>*@

                                    <td class="text-right">
                                        @* @{if (item.estatus == "Nueva")
                                  {
                                    <a id="@(item.id)_approve" href="@Url.Action("AprobarBeneficiario", "CompanyPrepago", new { id = item.id })" class="btn btn-success btn-xs" >
                                        <span class="glyphicon glyphicon-ok"></span>
                                    </a>
                                  }
                                }
                                <a id="@(item.id)_edit" href="@Url.Action("EditBeneficiario", "CompanyPrepago", new { id = item.id })" class="btn btn-info btn-xs" >
                                    <span class="glyphicon glyphicon-edit"></span>
                                </a>*@
                                        <input type="text" id="Monto_@item.id" name="Monto" value="" maxlength="10" placeholder="Indique el monto" class="form-control Monto">
                                        <span id="field_@item.id"></span>
                                    </td>
                                </tr>                 
                            }
                        </tbody>

                    </table>

            </form>

        

        <!-- SECCION PARA botones de operaciones -->
        <div class="col-md-12 col-tabla-btn">
            <div class="pull-right">
                <input type="submit" class="btn btn-success btn-md" value="Procesar" />
                <a href="@Url.Action("FilterBeneficiarios", "CompanyPrepago", new { companyid = Model.companyid })" class="btn btn-danger btn-md">Regresar</a>
            </div>
        </div>

    </div>

    <script src="~/Scripts/jquery-2.1.3.min.js"></script>
    <script>
        function ValidarMontos() {
            $("#beneficiarios tbody tr").each(function (index) {
                var RegExPattern = /^(\d){3,10}$/;
                var idrow = $(this).data("row-key");
                var campo1, campo2, campo3, campo4;
                $(this).children("td").each(function (index2) {
                    switch (index2) {
                        case 0: campo1 = $(this).text();
                            break;
                        case 1: campo2 = $(this).text();
                            break;
                        case 2: campo3 = $(this).text();
                            break;
                        case 3: campo4 = $(this).find('.Monto').val();
                            break;
                    }
                })
                if (campo4 == "") {
                    alert('id ' + idrow + ' no incluye recarga');
                }
                else if (RegExPattern.test(campo4) == false) {
                    alert('Monto invalido (' + campo4 + ')');
                }
                else if (campo4 > 500) {
                    alert('El monto excede los valores permitidos (500)');
                }
                else {
                    alert('id ' + idrow + ' monto recarga: ' + campo4);
                }

            })
            return false;
        }
    </script>
    <!-- SECCION PARA botones de operaciones -->

    @*<div class="col-md-12 col-tabla-btn">
                <div class="pull-right">
                    <input type="submit" class="btn btn-success btn-md" value="Regresar" style="padding-right: 15px; padding-left: 15px; margin-left: 0px;" />
                </div>
            </div>*@

</div>
<!-- panel-body -->

</div>
<!-- panel -->

</div>

